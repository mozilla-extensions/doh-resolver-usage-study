From https://github.com/mozilla-extensions/doh-resolver-usage-study/issues/1#issue-671895693

# Request for data collection review form

**All questions are mandatory. You must receive review from a data steward peer on your responses to these questions before shipping new data collection.**

1) What questions will you answer with this data?

What fraction of users appearing to be on a Comcast network are actually using a Comcast DNS resolver?

2) Why does Mozilla need to answer these questions?  Are there benefits for users? Do we need this information to address product or business requirements?

We need to verify that the rate of mis-steering we're seeing is indeed explained by significant usage-rates of non-Comcast resolvers. Until we do, we can't proceed with the DoH rollout.

3) What alternative methods did you consider to answer these questions? Why were they not sufficient?

There's no way to measure resolver usage without this new data. We need to measure on the nameserver side - so we had to set up a new domain and ship this code to query it.

4) Can current instrumentation answer these questions?

No.

5) List all proposed measurements and indicate the category of data collection for each measurement, using the [Firefox data collection categories](https://wiki.mozilla.org/Firefox/Data_Collection) found on the Mozilla wiki.   

We are sending a single telemetry event with four extra keys. Three of the keys contain the results of looking up three domains:
1. doh.test - the canonical domain for CNAME-based discovery of network DoH endpoint
2. whoartthou - a domain that results in a well-known response when resolved via a Comcast resolver. Similar to doh.test - kind of a safety.
3. A uuid-subdomain of our canonical domain - <uuid>.firefox-resolver-usage-test.net

Each result is either the CNAME answer of the DNS lookup if it was present, or the list of IP addresses in the returned A records if present, or an empty string otherwise.

In addition to these three results, we also record the UUID generated by the client to use as the subdomain of the canonical domain.

This is Category 1 - technical data, because the lookups are only revealing information about the user's network environment. 

6) Please provide a link to the documentation for this data collection which describes the ultimate data set in a public, complete, and accurate way.

https://github.com/mozilla/doh-resolver-usage-study/blob/master/docs/TELEMETRY.md

7) How long will this data be collected?  Choose one of the following:

This data will only be collected during the study (currently tentatively scheduled to start on Aug 11 and run for a week or two)

8) What populations will you measure?

* Which release channels?

Release v79

* Which countries?

US only

* Which locales?

All

* Any other filters?  Please describe in detail below.

No.

9) If this data collection is default on, what is the opt-out mechanism for users?

Usual opt-out of studies in about:preferences

10) Please provide a general description of how you will analyze this data.

The UUIDs collected will be used to link request logs on our nameserver with the telemetry events. We'll then compare whether the requests we see from Comcast and non-Comcast resolvers on the nameserver end matches the events for which the doh.test result is and isn't the expected Comcast CNAME.

11) Where do you intend to share the results of your analysis?

Internally

12) Is there a third-party tool (i.e. not Telemetry) that you are proposing to use for this data collection? If so:

Yes. The request logs on the DNS nameserver. The contents of the nameserver logs are the full domain that was requested along with the IP of the resolver that was used. This has been given a Trust sign-off. We are using Route53 as our provider.
